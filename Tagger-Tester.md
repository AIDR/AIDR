The tagger tester is a program that can be used after deploying the tagger, to test it independently of the other modules.

It only requires the aidr-tagger module to be deployed.

## Command line

The tagger tester is run through the following command:

```
mvn test -DtaggerTesterTest PARAMETERS
```

These parameters are optional:

```
-Dconfig=FILE
-Dnitems-train=NUMBER (default 200)
-Dnitems-test=NUMBER (default 800)
-Dquiet=TRUE/FALSE (default false)
```

The _config_ is the name of the tagger configuration (or of a centralized configuration) to read properties that the tester needs to know to perform the testing.

The _nitems-train_ is the number of training (labelled) items to give to the tagger. It must be strictly larger than `sampleCountThreshold` which is the minimum number of items required to create a model.

The _nitems-test_ is the number of testing (unlabelled) items to give to the tagger. It can be any number greater than zero.

The _quiet_ option suppresses the print of the tweets. All other messages are printed even in _quiet_ mode.

## Text of training/testing tweets

All tweets generated by this tester are synthetic and randomly generated, but conform to a specific format.

Half of the training tweets have the "WHITE" attribute value, and are made of random 10-word sequences of the words "light", "clear", "snow", and "clouds."

Half of the training tweets have the "BLACK" attribute value, and are made of random 10-word sequences of the words "coal", "night", "coffee", and "ink."

Example training tweets:

```
light clear light snow snow clouds clear light clear light -> WHITE
clear clouds snow light clear snow clear clear light light -> WHITE
coal night coffee coffee night coal night ink ink night -> BLACK
night coffee night coal coal ink night coffee coal night -> BLACK
```

The testing tweets are generated in the same way, half of them correspond to "WHITE" tweets, half of them to "BLACK" tweets.

## Execution

The collector tester should perform the following steps:

1. Read the _collection-task_
1. Subscribe to the REDIS queue where the collector writes data. This thread will print to the screen the received tweets (just the timestamp and first 40 characters of the text), unless the _quiet_ option is specified. If subscription to REDIS fails, FAIL.
1. Call the collector's `/start` method to start a collection; if the return code is not OK, FAIL.
1. Wait for 1/2 of the _time_
1. Call the collector's  `/status` method to get the status of the collection.
1. If the status returned is not OK, FAIL.
1. Wait for 1/2 of the _time_
1. Call the collector's `/stop` method; if the return code is not OK, FAIL.
1. Call the collector's  `/status` method, if the status returned is different from "not running", FAIL.
1. Print the number of tweets received so far, if the number is zero, FAIL.
1. Exit with exit code 0 (success) otherwise.

FAIL means printing a clear and informative message describing the condition and exiting with code 1 (non success).

On interrupt by the user, the collector tester should attempt to call the collector's `/stop` method and exit with non-success code.

